<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nodes &mdash; 3.2.0+1.g44ea00f8</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="canonical" href="https://podpac.orguser/.ipynb_checkpoints/nodes-checkpoint.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> PODPAC
          </a>
              <div class="version">
                3.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aws.html">AWS Integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../why-podpac.html">Why PODPAC?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../coordinates.html">Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Supported Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../earthdata.html">NASA Earth Data Login</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aws-development.html">AWS Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wrapping-datasets.html">Wrapping Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Development Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PODPAC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Nodes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user/.ipynb_checkpoints/nodes-checkpoint.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nodes">
<h1>Nodes<a class="headerlink" href="#nodes" title="Permalink to this heading"></a></h1>
<p>This document describes the detailed interfaces for Pipeline nodes so that a user may know what to expect. It also documents some of the available nodes implemented as part of the core library.</p>
<p>… tbd … (for now see the <a class="reference external" href="https://github.com/creare-com/podpac/blob/develop/doc/source/developer/specs/nodes.md">DeveloperSpec</a>)</p>
<section id="datasource">
<h2>DataSource<a class="headerlink" href="#datasource" title="Permalink to this heading"></a></h2>
<p>DataSource nodes interface with remote geospatial data sources (i.e. raster images, DAP servers, numpy arrays) and define how to retrieve data from these remote sources using PODPAC coordinates. PODPAC defines common generic DataSource nodes (i.e. Array, PyDAP), but advanced users can define their own DataSource nodes by defining the methods to retrieve data (<code class="docutils literal notranslate"><span class="pre">get_data(coordinates,</span> <span class="pre">index)</span></code>) and the method to define the <code class="docutils literal notranslate"><span class="pre">native_coordinates</span></code> property (<code class="docutils literal notranslate"><span class="pre">get_native_coordinates()</span></code>).</p>
<p>Key properties of DataSource nodes include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: The location of the source data. Depending on the child node this can be a filepath, numpy array, or server URL).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">native_coordinates</span></code>: The PODPAC coordinates of the data in <code class="docutils literal notranslate"><span class="pre">source</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation</span></code>: Definition of the interpolation method to use with the data source.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nan_vals</span></code>: List of values from source data that should be interpreted as ‘no data’ or ‘nans’.</p></li>
</ul>
<p>To evaluate data at arbitrary PODPAC coordinates, users can input <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> to the eval method of the DataSource node. The DataSource <code class="docutils literal notranslate"><span class="pre">eval</span></code> process consists of the following steps:</p>
<ol class="arabic simple">
<li><p>Verify native coordinates support the dimensions of the requested coordinates</p></li>
<li><p>Remove extra dimensions from the requested coordinates</p></li>
<li><p>Intersect the requested coordinates with the native coordinates</p></li>
<li><p>Further down-select the necessary native coordinates if the requested coordinates are sparser than the native coordinates.</p></li>
<li><p>Retrieve data from the data source (<code class="docutils literal notranslate"><span class="pre">get_data</span></code>) at the subset of native coordinates</p></li>
<li><p>Interpolate the retrieved data to the locations of the requested coordinates</p></li>
</ol>
<section id="interpolation">
<h3>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this heading"></a></h3>
<p>The DataSource <code class="docutils literal notranslate"><span class="pre">interpolation</span></code> property defines how to handle interpolation of coordinates and data within the DataSource node. Based on a string or dictionary definition, the DataSource instantiates an Interpolation class that orchestrates the selection and use of different interpolators depending on the native and input coordinates. PODPAC natively supports an array of interpolator methods covering a wide range of use cases, but the user may also write their own <code class="docutils literal notranslate"><span class="pre">Interpolator</span></code> class to use in a specific circumstance. Under the hood, PODPAC leverages interpolation methods from xarray, scipy, and rasterio to do some of the heavy lifting.</p>
<p>Definition of the interpolation method on a DataSource node may either be a string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span>  <span class="c1"># nearest neighbor interpolation</span>
</pre></div>
</div>
<p>or a dictionary that supplies extra parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;spatial_tolerance&#39;</span><span class="p">:</span> <span class="mf">1.1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For the most advanced users, the interpolation definition supports defining different interpolation methods for different dimensions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">):</span> <span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;nearest&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When a DataSource node is created, the interpolation manager selects a list of applicable <code class="docutils literal notranslate"><span class="pre">Interpolator</span></code> classes to apply to each set of defined dimensions. When a DataSource node is being evaluated, the interpolation manager chooses the first interpolator that is capable of handling the dimensions defined in the requested coordinates and the native coordinates using the <code class="docutils literal notranslate"><span class="pre">can_interpolate</span></code> method. After selecting an interpolator for all sets of dimensions, the manager sequentially interpolates data for each set of dimensions using the <code class="docutils literal notranslate"><span class="pre">interpolate</span></code> method.</p>
</section>
</section>
<section id="compositor">
<h2>Compositor<a class="headerlink" href="#compositor" title="Permalink to this heading"></a></h2>
<p>… tbd …</p>
</section>
<section id="algorithm">
<h2>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this heading"></a></h2>
<p>… tbd …</p>
</section>
<section id="extending-podpac-with-custom-nodes">
<h2>Extending Podpac with Custom Nodes<a class="headerlink" href="#extending-podpac-with-custom-nodes" title="Permalink to this heading"></a></h2>
<p>In addition to the core data sources and algorithms, you may need to write your own node to handle unique data sources or additional data processing. You can do this by subclassing a core podpac node and extending it for your needs. The DataSource node in particular is designed to be extended for new sources of data.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<p>An example of creating a simple array-based datasource can be found in the <a class="reference external" href="https://github.com/creare-com/podpac/blob/master/doc/notebooks/array-data-source.ipynb">array-data-source</a> notebook.</p>
</section>
<section id="tagging-attributes">
<h3>Tagging attributes<a class="headerlink" href="#tagging-attributes" title="Permalink to this heading"></a></h3>
<p>Node attributes are defined when instantiating the node. For each attribute, the class definition should include a traitlets attribute that is tagged as an <code class="docutils literal notranslate"><span class="pre">attr</span></code>, and you can optionally include a default value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDataSource</span><span class="p">(</span><span class="n">DataSource</span><span class="p">):</span>
    <span class="n">my_attr1</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">my_attr2</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">default_value</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>You will be able to set attrs when instantiating the node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">MyDataSource</span><span class="p">(</span><span class="n">my_attr1</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">my_attr2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p>You will also be able to set these tagged attrs in <a class="reference internal" href="#pipelines"><span class="xref myst">pipelines</span></a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2023, Creare.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>