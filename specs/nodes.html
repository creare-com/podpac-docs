

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; 1.3.1</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  
    <link rel="canonical" href="https://podpac.orgspecs/nodes.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/icon.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html#id18">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html#id71">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html#id92">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodes.html">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodes.html#id10">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodes.html#id19">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodes.html#id22">}</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nodes.html#id25">}</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PODPAC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/specs/nodes.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># Requirements
* Must provide an evaluation interface with consistent rules for outputs
* Must provide a way of instantiating outputs following these rules
* Provide methods to test if these rules are obeyed for child classes
* Provide a consistent interface/rules for passing runtime parameters
* Must provide an interface for finding available coordinates within a pipeline
* Must provide an interface for caching and retrieving cached results
* Must provide methods to inspect the complete pipeline and:</p>
<blockquote>
<div><ul class="simple">
<li><p>Ouput json formatted text used to reproduce it</p></li>
<li><p>Report inconsistencies or inabilities to produce pipelines</p></li>
<li><p>Evaluate pipelines at a point with indications of where data came from (which nodes are active within compositors)</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Must give the same output if evaluated from a newly instantiated node, or previously instantiated and evaluated node</p></li>
<li><p>Must define public attributes that should be implemented/available to all nodes</p></li>
<li><p>Must define public parameters that should be implemented/available to all nodes</p></li>
<li><p>Potentially provide a mechanism to evaluate nodes in parallel or remotely on the cloud (This may be handled by an evaluation manager)</p></li>
<li><p>Could provide a method to estimate cost of executing a job over given coordinates using AWS cloud</p></li>
<li><dl class="simple">
<dt>Provide a standard methods for creators of child nodes to:</dt><dd><ul>
<li><p>Specify defaults for attributes and parameters</p></li>
<li><p>Specify defaults for input nodes</p></li>
<li><p>initialze the node without overwriting __init__</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p># Example Use cases
## Typical
* The primary use case is essentially: A user evaluates nodes written by various authors with the same set of coordinates and the results can interact together using common mathematical operators (e.g. +-/<a href="#id1"><span class="problematic" id="id2">*</span></a>)
* A users wants to retrieve all of the available times for a complex node pipeline in the native coordinates of the underlying datasets</p>
<blockquote>
<div><ul class="simple">
<li><p>In this case, there may be multiple datasets spanning different times with different temporal resolutions</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>After interactively creating a complex processing pipeline, a users wants to:</dt><dd><ul>
<li><p>share their work using the .json format</p></li>
<li><p>evaluate the node for a larger region using cloud-resources</p></li>
<li><p>inspect outputs from various stages of the algorithm to debug/analyze the results</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>## Advanced
* Advanced users create new nodes to interface with custom data sources</p>
<blockquote>
<div><ul class="simple">
<li><p>May specify cachining behaviour for expensive to calculate quantities such as indexes</p></li>
<li><p>May specify settings that should be saved as part of the user’s setting file</p></li>
<li><p>Should be able to test if node is properly implemented</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Advanced users create new nodes to implement custom algorithms (see Algorithm Node spec)</p></li>
<li><p>Advanced users create new nodes to composite various nodes together following custom rules (see Compositor Node spec)</p></li>
<li><p>Advanced users create new nodes to construct pipelines from custom json (see Pipeline Node spec)</p></li>
<li><p>Advanced users inspect results from an evaluation by examining the cached data quantities (see caching spec)</p></li>
</ul>
<p># Specification
## User Interface
Starting from here for examples below:
<code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span>
<span class="pre">import</span> <span class="pre">traitlets</span> <span class="pre">as</span> <span class="pre">tl</span>
<span class="pre">from</span> <span class="pre">podpac.core.node</span> <span class="pre">import</span> <span class="pre">Node</span>
<span class="pre">from</span> <span class="pre">podpac.core.coordinate</span> <span class="pre">import</span> <span class="pre">Coordinate</span>
<span class="pre">from</span> <span class="pre">podpac.core.units</span> <span class="pre">import</span> <span class="pre">UnitsDataArray,</span> <span class="pre">ureg</span>
<span class="pre">node</span> <span class="pre">=</span> <span class="pre">Node()</span>
<span class="pre">`</span></code>
### Methods
#### __init__(…)
* Any attributes set at this stage are constant for all executions</p>
<p>#### eval(coordinates, output=None, method=None)
<a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a>python
def eval(coordinates, output=None, method=None):</p>
<blockquote>
<div><p>‘’’
Parameters
———–
coordinates : podpac.Coordinate</p>
<blockquote>
<div><p>The set of coordinates requested by a user. The Node will be evaluated using these coordinates.</p>
</div></blockquote>
<dl class="simple">
<dt>output<span class="classifier">podpac.UnitsDataArray, optional</span></dt><dd><p>Default is None. Optional input array used to store the output data. When supplied, the node will not allocate its own memory for the output array. This array needs to have the correct dimensions and coordinates.</p>
</dd>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Default is None. How the node will be evaluated: serial, parallel, on aws, locally, etc. Currently only local evaluation is supported.</p>
</dd>
</dl>
<p>podpac.core.units.UnitsDataArray</p>
<p>NotImplementedError: Base class raises this because the interface needs to be implemented by children.
CoordinateError: If Node contains a dimension not present in the requsted coordinates
‘’’
pass</p>
</div></blockquote>
<p><a href="#id7"><span class="problematic" id="id8">``</span></a><a href="#id9"><span class="problematic" id="id10">`</span></a></p>
<p><a href="#id11"><span class="problematic" id="id12">**</span></a>Notes on what’s returned: **
* This function should always return a <cite>UnitsDataArray</cite> object.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">[.]</span> <span class="pre">node.native_coordinates</span> <span class="pre">=</span> <span class="pre">Coordinate(lat=(90,</span> <span class="pre">-90,</span> <span class="pre">-1.),</span> <span class="pre">lon=(-180,</span> <span class="pre">180,</span> <span class="pre">2.),</span> <span class="pre">order=['lat',</span> <span class="pre">'lon'])</span>
<span class="pre">[.]</span> <span class="pre">type(node.initialize_output_array())</span>
<span class="pre">podpac.core.units.UnitsDataArray</span>
<span class="pre">`</span></code></p>
</div></blockquote>
<ul>
<li><p>This <cite>UnitsDataArray</cite> may contain the following dimensions <cite>[‘lat’, ‘lon’, ‘time’, ‘alt’]</cite></p></li>
<li><dl>
<dt>For cases with multiple outputs, it may additionally contain the field <cite>band</cite></dt><dd><ul class="simple">
<li><p>This is to supported datasets such as multi-spectral imagery</p></li>
</ul>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a>python
grey = UnitsDataArray(np.ones((2, 1)), dims=[‘lat’, ‘lon’], coords=[[0, 1], [0]])
rgba = UnitsDataArray(np.ones((2, 1, 4)), dims=[‘lat’, ‘lon’, ‘band’], coords=[[0, 1], [0], [‘r’, ‘g’, ‘b’, ‘a’]])
grey + rgba
&lt;xarray.UnitsDataArray (lat: 2, lon: 1, band: 4)&gt;
array([[[2., 2., 2., 2.]],</p>
<blockquote>
<div><p>[[2., 2., 2., 2.]]])</p>
</div></blockquote>
<dl class="simple">
<dt>Coordinates:</dt><dd><ul class="simple">
<li><p>lat      (lat) int32 0 1</p></li>
<li><p>lon      (lon) int32 0</p></li>
<li><p>band    (band) &lt;U1 ‘r’ ‘g’ ‘b’ ‘a’</p></li>
</ul>
</dd>
</dl>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a>`
* This requres that all the bands have the same <cite>units</cite>
<a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a>python
grey = UnitsDataArray(np.ones((2, 1)), dims=[‘lat’, ‘lon’],</p>
<blockquote>
<div><p>coords=[[0, 1], [0]], attrs={‘units’: ureg.m})</p>
</div></blockquote>
<dl class="simple">
<dt>rgba1 = UnitsDataArray(np.ones((2, 1, 4)), dims=[‘lat’, ‘lon’, ‘band’],</dt><dd><p>coords=[[0, 1], [0], [‘r’, ‘g’, ‘b’, ‘a’]],
attrs={‘units’: ureg.km})</p>
</dd>
</dl>
<p>grey + rgba1
&lt;xarray.UnitsDataArray (lat: 2, lon: 1, band: 4)&gt;
array([[[1001., 1001., 1001., 1001.]],</p>
<blockquote>
<div><p>[[1001., 1001., 1001., 1001.]]])</p>
</div></blockquote>
<dl class="simple">
<dt>Coordinates:</dt><dd><ul class="simple">
<li><p>lat      (lat) int32 0 1</p></li>
<li><p>lon      (lon) int32 0</p></li>
<li><p>band    (band) &lt;U1 ‘r’ ‘g’ ‘b’ ‘a’</p></li>
</ul>
</dd>
<dt>Attributes:</dt><dd><p>units:    meter</p>
</dd>
</dl>
<p><a href="#id23"><span class="problematic" id="id24">``</span></a>`
* [<strong>FUTURE FEATURE</strong>] We could support different units for differents bands as follows, but the dimensionality still has to be consistent, unless a specific band is selected
<a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>python
[.] rgba2 = UnitsDataArray(np.ones((2, 1, 4)), dims=[‘lat’, ‘lon’, ‘band’],</p>
<blockquote>
<div><p>coords=[[0, 1], [0], [‘r’, ‘g’, ‘b’, ‘a’]],
attrs={‘units’: {‘r’: ureg.m, ‘g’: ureg.ft,</p>
<blockquote>
<div><p>‘b’: ureg.km, ‘a’: ureg.mile}})</p>
</div></blockquote>
</div></blockquote>
<p>[.] grey + rgba2
&lt;xarray.UnitsDataArray (lat: 2, lon: 1, band: 4)&gt;
array([[[2., 1.3048, 1001., 1610.344]],</p>
<blockquote>
<div><p>[[2., 1.3048, 1001., 1610.344]]])</p>
</div></blockquote>
<dl class="simple">
<dt>Coordinates:</dt><dd><ul class="simple">
<li><p>lat      (lat) int32 0 1</p></li>
<li><p>lon      (lon) int32 0</p></li>
<li><p>band    (band) &lt;U1 ‘r’ ‘g’ ‘b’ ‘a’</p></li>
</ul>
</dd>
<dt>Attributes:</dt><dd><p>units:    {‘r’: &lt;Unit(‘meter’)&gt;, ‘g’: &lt;Unit(‘foot’)&gt;, ‘b’: &lt;Unit(‘kilomet…</p>
</dd>
</dl>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
</dd>
</dl>
</li>
<li><dl>
<dt>Dimensions should be returned in the order of the requested <cite>coordinates</cite></dt><dd><ul class="simple">
<li><p>eg. if underlying dataset has <cite>[‘lat’, ‘lon’]</cite> <cite>coordinates</cite>, but the request has <cite>[‘lon’, ‘lat’]</cite> coordinates, the output should match <cite>[‘lon’, ‘lat’]</cite></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">[.]</span> <span class="pre">node.native_coordinates</span> <span class="pre">=</span> <span class="pre">Coordinate(lat=(90,</span> <span class="pre">-90,</span> <span class="pre">-1.),</span> <span class="pre">lon=(-180,</span> <span class="pre">180,</span> <span class="pre">2.),</span> <span class="pre">order=['lat',</span> <span class="pre">'lon'])</span>
<span class="pre">[.]</span> <span class="pre">node.evaluated_coordinates</span> <span class="pre">=</span> <span class="pre">Coordinate(lon=(-180,</span> <span class="pre">180,</span> <span class="pre">4.),</span> <span class="pre">lat=(90,</span> <span class="pre">-90,</span> <span class="pre">-2.),</span> <span class="pre">order=['lon',</span> <span class="pre">'lat'])</span>
<span class="pre">[.]</span> <span class="pre">node.initialize_output_array().dims</span>
<span class="pre">('lon',</span> <span class="pre">'lat')</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
</li>
<li><dl>
<dt>If the underlying Node has unstacked dimensions not in the request, an exception is raised</dt><dd><ul class="simple">
<li><p>eg. Node has <cite>[‘lat’, ‘lon’, ‘time’]</cite> dimensions, but coordinates only have <cite>[‘time’]</cite></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">[.]</span> <span class="pre">node.native_coordinates</span> <span class="pre">=</span> <span class="pre">Coordinate(lat=(90,</span> <span class="pre">-90,</span> <span class="pre">-1.),</span> <span class="pre">lon=(-180,</span> <span class="pre">180,</span> <span class="pre">2.),</span> <span class="pre">order=['lat',</span> <span class="pre">'lon'])</span>
<span class="pre">[.]</span> <span class="pre">node.evaluated_coordinates</span> <span class="pre">=</span> <span class="pre">Coordinate(lon=(-180,</span> <span class="pre">180,</span> <span class="pre">4.),)</span>
<span class="pre">[.]</span> <span class="pre">node.initialize_output_array()</span>
<span class="pre">CoordinateError:</span> <span class="pre">'Dimension</span> <span class="pre">&quot;lat&quot;</span> <span class="pre">not</span> <span class="pre">present</span> <span class="pre">in</span> <span class="pre">requested</span> <span class="pre">coordinates</span> <span class="pre">with</span> <span class="pre">dims</span> <span class="pre">[&quot;lon&quot;]'</span>
<span class="pre">`</span></code>
* Because some datasets may be huge, and without information about the subset, the safest behaviour is to throw an exception</p>
</dd>
</dl>
</li>
<li><p>If the underlying Node has <em>stacked</em> dimensions not in the request, raise an exception if the Node native_coordinates contains duplicates for the requested dimensions, otherwise just drop the missing dimension from the coordinates.
* eg. Node has <cite>[lat_lon_time]</cite> dimensions, but coordinates only have <cite>[‘time’</cite>], we can drop the lat and lon portion of the stacked coordinates as long as that doesn’t result in duplicate times. Note that this doesn’t change the dimensionality, but is required for correct xarray broadcasting.</p></li>
<li><dl>
<dt>If the request has unstacked dimensions not in the Node, just return without those dimensions</dt><dd><ul class="simple">
<li><p>eg. Node has <cite>[‘lat’, ‘lon’]</cite> dimensions, but evaluated coordinates have <cite>[‘time’, ‘lon’, ‘lat’]</cite> then <cite>UnitsDataArray</cite> will have dimensions <cite>[‘lon’, ‘lat’]</cite></p></li>
</ul>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a><a href="#id35"><span class="problematic" id="id36">`</span></a>python
[.] node.native_coordinates = Coordinate(lat=45, lon=0, order=[‘lat’, ‘lon’])
[.] node.evaluated_coordinates = Coordinate(lat=45, lon=0, time=’2018-01-01’, order=[‘lat’, ‘lon’, ‘time’])
[.] node.initialize_output_array()
&lt;xarray.UnitsDataArray (lat: 1, lon: 1)&gt;
array([[nan]])
Coordinates:</p>
<blockquote>
<div><ul class="simple">
<li><p>lat      (lat) float64 45.0</p></li>
<li><p>lon      (lon) float64 0.0</p></li>
</ul>
</div></blockquote>
<p><a href="#id37"><span class="problematic" id="id38">``</span></a><a href="#id39"><span class="problematic" id="id40">`</span></a></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If the request has <em>stacked</em> dimensions not in the underlying Node, add the missing coordinates.</dt><dd><ul class="simple">
<li><p>eg. Node has <cite>[lat_lon]</cite> dimensions, but coordinates have <cite>[‘lat_lon_time’</cite>], we need to add the time portion to the stacked coordinates for correct xarray broadcasting.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The output will contain metadata on the:</dt><dd><ul class="simple">
<li><p>Units</p></li>
<li><p>Styling?</p></li>
<li><p>Other metadata to track provenance?</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>#### eval_group(group_coordinates, method=None)</p>
<p>This is just a helper function that loops through the coordinates in the group calling eval.</p>
<dl>
<dt><a href="#id41"><span class="problematic" id="id42">``</span></a><a href="#id43"><span class="problematic" id="id44">`</span></a>python</dt><dd><dl>
<dt>def eval_group(self, group_coordinates, method=None):</dt><dd><p>‘’’Evaluate GroupCoordinates in a loop.</p>
<dl class="simple">
<dt>group_coordinates<span class="classifier">GroupCoordinates</span></dt><dd><p>coordinates group to evaluate</p>
</dd>
</dl>
<dl class="simple">
<dt>outputs<span class="classifier">list</span></dt><dd><p>list of UnitsDataArray, one for each Coordinates in the group.</p>
</dd>
</dl>
<p>‘’’</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id45"><span class="problematic" id="id46">``</span></a><a href="#id47"><span class="problematic" id="id48">`</span></a></p>
<p>#### find_coordinates
<a href="#id49"><span class="problematic" id="id50">``</span></a><a href="#id51"><span class="problematic" id="id52">`</span></a>python
def find_coordinates(dims=None, bounds=None, number=None, sortby=’size’, stop_types=[Compositor, DataSource]):</p>
<blockquote>
<div><dl class="simple">
<dt>‘’’This is a helper function to get all the native coordinates within a pipeline, sorted by</dt><dd><p>the largest extents, or highest resolution</p>
</dd>
</dl>
<dl class="simple">
<dt>dims<span class="classifier">str/list, optional</span></dt><dd><p>The dimension or set of dimensions for which the user wants to find the underlying dataset coordinates. If None, all available dimensions for underlying coordinates will be found. Stacked dimensions cannot be used (or are automatically unstacked)</p>
</dd>
<dt>bounds<span class="classifier">dict, optional</span></dt><dd><p>Default is None, in which case search is not restricted to a bounding window. Bound within which to search for coordinates. Format should be {‘dim’: (start, end)}</p>
</dd>
<dt>number<span class="classifier">int, optional</span></dt><dd><p>Default is None, in which case all coordinates found are returned. Otherwise, only the first <cite>number</cite> of coordinates are returned, based on the <cite>sortby</cite> specified. If number is &lt;0, the the last <cite>number</cite> of coordinates are returned.</p>
</dd>
<dt>sortby<span class="classifier">str, optional</span></dt><dd><p>Default is ‘size’. <cite>sortby</cite> should be in [‘size’, ‘extents’]. If ‘size’, the returned coordinates are sorted by the number of coordinates in the dimension, with the largest first. If ‘extents’, the returned coordinates are sorted by the largest geographical extent. In case of ties, the sorting looks at the other option to break the tie.</p>
</dd>
<dt>stop_type<span class="classifier">list, optional</span></dt><dd><p>List of node types where search should be stopped. By default, searches stop at DataSource and Compositor nodes. Remove the compositor node to search for native coordinates of individual files, but this may take a long time.</p>
</dd>
</dl>
<dl>
<dt>OrderedDict:</dt><dd><blockquote>
<div><dl>
<dt>Format is as follows: {dims[0]: {‘node_address0’: Coordinate1D,</dt><dd><blockquote>
<div><p>‘node_address1’: Coordinate1D, …},</p>
</div></blockquote>
<dl class="simple">
<dt>dims[1]: {‘node_address2’: Coordinate1D,</dt><dd><p>‘node_address0’: Coordinate1D, …}}</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>where find_coordinates(dims)[dims[0]].items() are sorted as specified</p>
</dd>
</dl>
<p>The <cite>native_coordinates</cite> could be retrieved using (for example):
[.] c = node.find_coordinates(‘time’)
[.] node_key = list(c[‘time’].keys())[0]
[.] node[node_key].native_coordinates
‘’’
pass</p>
</div></blockquote>
<p><a href="#id53"><span class="problematic" id="id54">``</span></a><a href="#id55"><span class="problematic" id="id56">`</span></a></p>
<p>#### public cache interface</p>
<p>Put data into the cache:</p>
<p><a href="#id57"><span class="problematic" id="id58">``</span></a><a href="#id59"><span class="problematic" id="id60">`</span></a>python
def put_cache(self, data, key, coordinates=None):</p>
<blockquote>
<div><p>‘’’Cache data for this node.</p>
<dl class="simple">
<dt>data<span class="classifier">any</span></dt><dd><p>Data to cache</p>
</dd>
<dt>key<span class="classifier">str</span></dt><dd><p>Cached object key, e.g. ‘output’.</p>
</dd>
<dt>coordinates<span class="classifier">Coordinates, optional</span></dt><dd><p>Coordinates for which cached object should be retrieved, for coordinate-dependent data such as evaluation output</p>
</dd>
</dl>
<p>‘’’</p>
</div></blockquote>
<p><a href="#id61"><span class="problematic" id="id62">``</span></a><a href="#id63"><span class="problematic" id="id64">`</span></a></p>
<p>Get data from the cache:</p>
<p><a href="#id65"><span class="problematic" id="id66">``</span></a><a href="#id67"><span class="problematic" id="id68">`</span></a>python
def get_cache(self, key, coordinates=None):</p>
<blockquote>
<div><p>‘’’Get cached data for this node.</p>
<dl class="simple">
<dt>key<span class="classifier">str</span></dt><dd><p>Cached object key, e.g. ‘output’.</p>
</dd>
<dt>coordinates<span class="classifier">Coordinates, optional</span></dt><dd><p>Coordinates for which cached object should be retrieved, for coordinate-dependent data such as evaluation output</p>
</dd>
</dl>
<dl class="simple">
<dt>data<span class="classifier">any</span></dt><dd><p>The cached data.</p>
</dd>
</dl>
<dl class="simple">
<dt>CacheError</dt><dd><p>If the data is not in the cache.</p>
</dd>
</dl>
<p>‘’’</p>
</div></blockquote>
<p><a href="#id69"><span class="problematic" id="id70">``</span></a><a href="#id71"><span class="problematic" id="id72">`</span></a></p>
<p>Clear the cache:</p>
<p><a href="#id73"><span class="problematic" id="id74">``</span></a><a href="#id75"><span class="problematic" id="id76">`</span></a>python
def del_cache(self, key=None, coordinates=None):</p>
<blockquote>
<div><p>‘’’Delete cached data for this node.</p>
<dl class="simple">
<dt>key<span class="classifier">str, optional</span></dt><dd><p>Delete only cached objects with this key.</p>
</dd>
<dt>coordinates<span class="classifier">Coordinates</span></dt><dd><p>Delete only cached objects for these coordinates.</p>
</dd>
</dl>
<p>‘’’</p>
</div></blockquote>
<p><a href="#id77"><span class="problematic" id="id78">``</span></a><a href="#id79"><span class="problematic" id="id80">`</span></a></p>
<blockquote>
<div><ul class="simple">
<li><p>delete the entire cache for this node: <cite>node.del_cache()</cite></p></li>
<li><p>delete a specific cached object (coordinate-depedent): <cite>node.del_cache(key=mykey, coordinates=coords)</cite></p></li>
<li><p>delete a specific cached object (coordinate-independent): <cite>node.del_cache(key=mykey)</cite></p></li>
<li><p>delete all cached data for this node for specific coordinates: <cite>node.del_cache(coordinates=coords)</cite></p></li>
<li><p>delete all cached objects for this node with a given key for any coordinates: <cite>node.del_cache(key=mykey)</cite></p></li>
</ul>
</div></blockquote>
<p>Just check the cache:</p>
<p><a href="#id81"><span class="problematic" id="id82">``</span></a><a href="#id83"><span class="problematic" id="id84">`</span></a>python
def has_cache(self, key, coordinates=None):</p>
<blockquote>
<div><p>‘’’Check for cached data for this node</p>
<dl class="simple">
<dt>key<span class="classifier">str</span></dt><dd><p>Cached object key, e.g. ‘output’.</p>
</dd>
<dt>coordinates: Coordinate, optional</dt><dd><p>Coordinates for which cached object should be checked</p>
</dd>
</dl>
<dl class="simple">
<dt>has_cache<span class="classifier">bool</span></dt><dd><p>True if there as a cached object for this node for the given key and coordinates.</p>
</dd>
</dl>
<p>‘’’</p>
</div></blockquote>
<p><a href="#id85"><span class="problematic" id="id86">``</span></a><a href="#id87"><span class="problematic" id="id88">`</span></a></p>
<p>### definition
<a href="#id89"><span class="problematic" id="id90">``</span></a><a href="#id91"><span class="problematic" id="id92">`</span></a>python
def definition(self, type=’dict’):</p>
<blockquote>
<div><p>‘’’ Returns the pipeline node definition in the desired format</p>
<dl class="simple">
<dt>type: str, optional</dt><dd><p>Default is ‘dict’, which returns a dictionary definition of the pipeline.
‘json’: returns a json-formatted text string of the pipeline
‘rich’: returns a javascript widget &lt;– should this be ‘widget’ instead?
‘node’: Returns a PipelineNode instance of this object</p>
</dd>
</dl>
<dl class="simple">
<dt>various</dt><dd><p>Depends on type, see above.</p>
</dd>
</dl>
<p>‘’’</p>
</div></blockquote>
<p><a href="#id93"><span class="problematic" id="id94">``</span></a>`
* There are a few shortcut properties that call this function</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>pipeline_json</cite></p></li>
<li><p><cite>pipeline_rich</cite></p></li>
<li><p><cite>pipeline_dict</cite></p></li>
<li><p><cite>pipeline_node</cite></p></li>
</ul>
</div></blockquote>
<p>## Developer interface
### Public Attributes
* <cite>native_coordinates</cite>: Underlying data source coordiantes, when available
* <cite>units</cite>: Units associated with the output of this node
* <cite>interpolation</cite>: Interpolation method used with this node</p>
<p>### Private Attributes
* <cite>_output</cite>: last output from this node - property, looks in cache
* <cite>_requested_coordinates</cite>: last coordinates used for evaluating the node
* <cite>_output_coordinates</cite>: output coordinates from the last evaluation</p>
<p>### Additional public methods
( Some of these are already documented in the code )
* cache_path: file where object is cached
* cache_dir: directory where objects are cached
* init: Used for initialization of derived classes
* _first_init: Used to do any initialization before any of the core initialization is done
* create_output_array
* get_cached_object: similar go ‘get’, but specifies a particular filename? Maybe superceded by caching refactor?
* save_to_disk?</p>
<p>### Testing
* I think testing should live in the common_test_utils. I.e. separate from this node.</p>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2020, Creare

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>